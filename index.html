<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>تفعيل البصمة</title>
</head>
<body style="font-family: Tahoma; text-align: center; margin-top: 100px;">

  <h2>مرحبا 👋</h2>
  <p id="message" style="color: #c00; font-size: 18px;">
    التجربة لم تحقق منهويتك، لا تغلق الصفحة حتى يتم التفعيل بالبصمة.
  </p>

  <button onclick="verifyFingerprint()" style="padding: 10px 20px; font-size: 18px;">
    تفعيل باستخدام البصمة
  </button>

  <script>
    async function verifyFingerprint() {
      try {
        const assertion = await navigator.credentials.get({
          publicKey: {
            challenge: new Uint8Array([1, 2, 3, 4, 5, 6]),
            timeout: 60000,
            userVerification: 'preferred'
          }
        });

        const res = await fetch("https://osama88.app.n8n.cloud/webhook/fingerprint-test", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            verified: true,
            employeeId: "12345",
            timestamp: new Date().toISOString()
          })
        });

        document.getElementById("message").innerText = "✅ تم التحقق بنجاح، شكراً لك!";
        document.getElementById("message").style.color = "green";

      } catch (err) {
        console.error("Fingerprint failed:", err);
        document.getElementById("message").innerText = "فشل التحقق، الرجاء المحاولة مرة أخرى.";
        document.getElementById("message").style.color = "#c00";
      }
    }
  </script>

</body>
</html>
